import{v as x,r as d,c as o}from"./index-B7Pz_r6u.js";import{a as n}from"./client-H5C7n97n.js";const L=x("player",()=>{const t=d(null),i=d([]),l=d(!1),r=d(null),p=o(()=>{var e;return((e=t.value)==null?void 0:e.player_id)||"default"}),f=o(()=>{var e;return((e=t.value)==null?void 0:e.xp)||0}),y=o(()=>{var e;return((e=t.value)==null?void 0:e.level)||0}),m=o(()=>{var e,a;return((e=t.value)==null?void 0:e.display_name)||((a=t.value)==null?void 0:a.player_id)||"Player"}),v=o(()=>i.value.filter(e=>e.unlocked)),_=o(()=>i.value.filter(e=>!e.unlocked&&e.progress!==void 0));async function h(){l.value=!0,r.value=null;try{const e=await n.get("/api/profile?player_id=default");t.value=e.data}catch(e){r.value=e instanceof Error?e.message:"Failed to load profile"}finally{l.value=!1}}async function k(){l.value=!0,r.value=null;try{const e=await n.get("/api/achievements?player_id=default");i.value=[...e.data.unlocked.map(a=>({...a,unlocked:!0})),...e.data.in_progress.map(a=>({...a,unlocked:!1}))]}catch(e){r.value=e instanceof Error?e.message:"Failed to load achievements"}finally{l.value=!1}}async function g(e,a,s){try{await n.post("/api/emotional/record",{player_id:"default",enjoyment:e==="RT"?a:0,frustration:e==="LT"?a:0,context:s,interacted:a>0})}catch(u){console.error("Failed to record emotional feedback:",u)}}async function F(e,a,s,u,P=!0){try{const c=await n.post("/api/emotional/record",{player_id:"default",enjoyment:e,frustration:a,challenge_id:s,stage:u,context:s?`challenge:${s}`:"general",interacted:P});return{skipped:c.data.skipped,mastery_factor:c.data.mastery_factor}}catch(c){return console.error("Failed to record satisfaction:",c),{skipped:!1}}}async function w(e){try{const a=await n.post("/api/profile/display-name",{player_id:"default",display_name:e});return a.data.success&&t.value&&(t.value.display_name=a.data.display_name),a.data.success}catch(a){return console.error("Failed to set display name:",a),!1}}return{profile:t,achievements:i,isLoading:l,error:r,playerId:p,totalXP:f,playerLevel:y,displayName:m,unlockedAchievements:v,inProgressAchievements:_,loadProfile:h,loadAchievements:k,recordEmotionalFeedback:g,recordSatisfaction:F,setDisplayName:w}});export{L as u};
