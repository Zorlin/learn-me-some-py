import{d as $,r as b,a as j,o as R,c as f,l as z,b as n,g as r,m as A,p as u,F as y,i as w,j as O,t as l,q as S,f as F,s as T,k as a,_ as q}from"./index-C9SLr4DQ.js";import{c as D}from"./client-H5C7n97n.js";import{R as N}from"./RadialProgress-D5R5qvE0.js";const E={class:"responsive-container-wide py-responsive"},G={class:"level-filter-row"},I=["onClick"],P={class:"level-btn-content"},U={class:"level-label"},H={key:0,class:"level-progress-container"},J={class:"level-stats-text"},K={key:1,class:"level-empty-progress"},Q={key:0,class:"text-center py-12 text-text-muted"},W={key:1,class:"text-center py-12"},X={key:2},Y={class:"text-responsive-heading mb-4 text-accent-secondary"},Z={class:"responsive-grid"},ee=["onClick"],se={class:"flex items-start justify-between"},te={class:"flex-1"},oe={class:"flex items-center gap-2 mb-2"},re={class:"level-badge"},ae={class:"font-bold text-lg"},ne={class:"text-accent-primary font-mono text-sm mt-1"},le={class:"progress-container"},ie={key:1,class:"empty-progress"},ce=$({__name:"ChallengesView",setup(de){const k=O(),v=b([]),_=b(!0),c=b(null);j({onBack:()=>k.push("/")}),R(async()=>{await B()});async function B(){_.value=!0;const o=await D.list();o.ok&&(v.value=o.data),_.value=!1}const x=f(()=>c.value===null?v.value:v.value.filter(o=>o.level===c.value)),h=f(()=>{const o={};for(const e of x.value)o[e.level]||(o[e.level]=[]),o[e.level].push(e);return o}),M=f(()=>Object.keys(h.value).map(Number).sort()),i=f(()=>{const o={};for(let e=0;e<=6;e++)o[e]={total:0,completed:0,mastered:0,needsReview:0,avgRetention:0};for(const e of v.value){const s=o[e.level];s.total++,e.progress&&(s.completed++,s.avgRetention+=e.progress.retention,e.progress.mastered&&s.mastered++,e.progress.needs_review&&s.needsReview++)}for(const e in o){const s=o[e];s.completed>0&&(s.avgRetention=s.avgRetention/s.completed)}return o});function V(o){k.push(`/challenge/${o}`)}function C(o){c.value=o,window.scrollTo({top:0,behavior:"smooth"})}function d(){window.scrollTo({top:0,behavior:"smooth"})}let m=null;return R(()=>{const o=document.querySelector(".level-filter-row");o&&(m=new MutationObserver(e=>{for(const s of e)if(s.type==="attributes"&&s.attributeName==="class"){const t=s.target;t.classList.contains("level-filter-btn")&&t.classList.contains("gamepad-focused")&&d()}}),m.observe(o,{attributes:!0,subtree:!0,attributeFilter:["class"]}))}),z(()=>{m&&m.disconnect()}),(o,e)=>(a(),n("div",E,[e[5]||(e[5]=r("h1",{class:"text-responsive-title mb-6 3xl:mb-8"},[r("span",{class:"text-accent-primary"},"ðŸ“š"),A(" Challenges ")],-1)),r("div",G,[r("button",{class:u(["level-filter-btn gamepad-focusable",{active:c.value===null}]),onClick:e[0]||(e[0]=s=>C(null)),onMouseenter:d,onFocus:d},[...e[1]||(e[1]=[r("span",{class:"level-filter-label"},"All",-1)])],34),(a(),n(y,null,w(7,s=>{var t,p;return r("button",{key:s-1,class:u(["level-filter-btn gamepad-focusable",{active:c.value===s-1,"has-progress":((t=i.value[s-1])==null?void 0:t.completed)>0}]),onClick:g=>C(s-1),onMouseenter:d,onFocus:d},[r("div",P,[r("span",U,"Level "+l(s-1),1),((p=i.value[s-1])==null?void 0:p.total)>0?(a(),n("div",H,[S(N,{percent:Math.round(i.value[s-1].avgRetention*(i.value[s-1].completed/i.value[s-1].total)),size:40,"stroke-width":4,"show-label":!0},null,8,["percent"]),r("span",J,l(i.value[s-1].completed)+"/"+l(i.value[s-1].total),1)])):(a(),n("div",K,[...e[2]||(e[2]=[r("span",{class:"level-empty-circle"},"â—‹",-1),r("span",{class:"level-stats-text"},"0/0",-1)])]))])],42,I)}),64))]),_.value?(a(),n("div",Q," Loading challenges... ")):x.value.length===0?(a(),n("div",W,[...e[3]||(e[3]=[r("div",{class:"text-4xl mb-4"},"ðŸ—ï¸",-1),r("div",{class:"text-text-secondary"},"No challenges available yet",-1)])])):(a(),n("div",X,[(a(!0),n(y,null,w(M.value,s=>(a(),n("div",{key:s,class:"mb-8"},[r("h2",Y," Level "+l(s),1),r("div",Z,[(a(!0),n(y,null,w(h.value[s],t=>{var p,g,L;return a(),n("div",{key:t.id,class:u(["challenge-card cursor-pointer gamepad-focusable",{"needs-review":(p=t.progress)==null?void 0:p.needs_review,mastered:(g=t.progress)==null?void 0:g.mastered,completed:t.progress&&!t.progress.needs_review&&!t.progress.mastered}]),onClick:pe=>V(t.id)},[r("div",se,[r("div",te,[r("div",oe,[r("div",re,"Lv."+l(t.level),1),(L=t.progress)!=null&&L.performance_grade&&t.progress.performance_grade!=="-"?(a(),n("div",{key:0,class:u(["grade-badge",`grade-${t.progress.performance_grade.toLowerCase()}`])},l(t.progress.performance_grade),3)):F("",!0)]),r("h3",ae,l(t.name),1),r("div",ne,l(t.points)+" pts ",1)]),r("div",le,[t.progress?(a(),T(N,{key:0,percent:t.progress.retention,size:48,"stroke-width":4,"show-label":!0},null,8,["percent"])):(a(),n("div",ie,[...e[4]||(e[4]=[r("span",{class:"empty-icon"},"â—‹",-1)])])),t.progress?(a(),n("div",{key:2,class:u(["progress-label",{"needs-review":t.progress.needs_review,mastered:t.progress.mastered}])},l(t.progress.mastered?"Mastered!":t.progress.needs_review?"Review!":t.progress.days_since<1?"Fresh!":`${Math.round(t.progress.days_since)}d ago`),3)):F("",!0)])])],10,ee)}),128))])]))),128))]))]))}}),fe=q(ce,[["__scopeId","data-v-982db7a2"]]);export{fe as default};
