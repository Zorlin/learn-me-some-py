# Level 5: Pytest Basics

[concept]
id = "pytest_basics"
name = "Pytest: Test Your Code"
level = 5
category = "testing"
order = 2

[content]
lesson = """
## Simple, Powerful Testing

Pytest makes testing feel natural - just assert:

```python
# test_math.py
def add(a, b):
    return a + b

def test_add_positive():
    assert add(2, 3) == 5

def test_add_negative():
    assert add(-1, -1) == -2

# Run with: pytest test_math.py
```

## Test Discovery

Pytest automatically finds tests:
- Files named `test_*.py` or `*_test.py`
- Functions named `test_*`
- Classes named `Test*`

## Testing Exceptions

```python
import pytest

def divide(a, b):
    if b == 0:
        raise ValueError("Cannot divide by zero")
    return a / b

def test_divide_by_zero():
    with pytest.raises(ValueError, match="Cannot divide by zero"):
        divide(10, 0)
```

## Parametrize: Multiple Test Cases

```python
import pytest

@pytest.mark.parametrize("a,b,expected", [
    (2, 3, 5),
    (0, 0, 0),
    (-1, 1, 0),
    (100, 200, 300),
])
def test_add(a, b, expected):
    assert add(a, b) == expected

# Runs 4 tests with one function!
```

## Comparing Floats

```python
def test_division():
    # WRONG - floating point issues
    # assert divide(1, 3) == 0.333333333333

    # RIGHT - use approx
    assert divide(1, 3) == pytest.approx(0.333, rel=1e-3)
```

## Common Commands

```bash
pytest                  # Run all tests
pytest test_file.py    # Run specific file
pytest -v              # Verbose output
pytest -x              # Stop on first failure
pytest -k "add"        # Run tests matching name
```

## Test Structure: AAA Pattern

```python
def test_user_creation():
    # Arrange - Set up
    name = "Alice"

    # Act - Do the thing
    user = User(name)

    # Assert - Check results
    assert user.name == "Alice"
```
"""

[content.try_it]
prompt = "Write a test for a function that checks if a number is even"
starter = '''
def is_even(n):
    return n % 2 == 0

# Write test functions for is_even

'''
solution = '''
def is_even(n):
    return n % 2 == 0

def test_even_number():
    assert is_even(4) == True

def test_odd_number():
    assert is_even(5) == False

def test_zero():
    assert is_even(0) == True

def test_negative_even():
    assert is_even(-2) == True
'''

[connections]
prerequisites = ["functions", "exceptions"]
enables = ["pytest_fixtures"]
used_in = []
see_also = ["exceptions"]

[meta]
time_to_read = 55
difficulty = "advanced"
tags = ["testing", "pytest", "quality"]
