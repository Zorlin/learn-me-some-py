# Level 3: Variable Scope

[concept]
id = "scope"
name = "Scope: Where Variables Live"
level = 3
category = "functions"
order = 3

[content]
lesson = """
## Local vs Global

**Scope** determines where a variable exists and can be used.

```python
hp = 100  # Global - exists everywhere

def take_damage(damage):
    local_var = 10  # Local - only exists in this function
    return hp - damage  # Can READ global

print(hp)         # 100 - works
print(local_var)  # ERROR! Doesn't exist here
```

## THE BUG: Trying to Modify Globals

```python
hp = 100

def take_damage(damage):
    hp = hp - damage  # UnboundLocalError!
    return hp
```

**Why?** Python sees `hp = ...` and thinks it's a LOCAL variable. But then `hp - damage` tries to read it before it's created!

## Fix 1: Use global Keyword

```python
hp = 100

def take_damage(damage):
    global hp  # "I want the global hp"
    hp = hp - damage
    return hp
```

## Fix 2: Pass and Return (BETTER!)

```python
def take_damage(current_hp, damage):
    return current_hp - damage

hp = 100
hp = take_damage(hp, 10)  # hp is now 90
```

This is clearer and easier to test!

## Reading vs Writing Globals

```python
MAX_HP = 100  # Global constant (reading is fine)

def get_health_percent(current_hp):
    return (current_hp / MAX_HP) * 100  # Reading global - OK!
```

## The Mutable Gotcha

```python
inventory = []  # Global

def add_item(item):
    inventory.append(item)  # This WORKS! No error!
    # Because we're calling a method, not reassigning

add_item("sword")
print(inventory)  # ["sword"]
```
"""

[content.try_it]
prompt = "Fix this function that tries to modify a global variable"
starter = '''
score = 0

def add_points(points):
    score = score + points  # This will error!
    return score

# Fix this function

'''
solution = '''
score = 0

def add_points(current_score, points):
    return current_score + points

# Usage:
score = add_points(score, 10)
print(score)  # 10
'''

[connections]
prerequisites = ["def_return", "parameters"]
enables = ["classes"]
used_in = []
see_also = ["functions", "parameters"]

[meta]
time_to_read = 60
difficulty = "intermediate"
tags = ["scope", "functions", "variables"]
