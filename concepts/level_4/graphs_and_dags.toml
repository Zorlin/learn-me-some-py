# Level 4: Graphs and DAGs

[concept]
id = "graphs_and_dags"
name = "Graphs and DAGs: Model Relationships"
level = 4
category = "data_structures"
order = 3

[content]
lesson = """
## Networks of Connections

Graphs connect nodes with edges. Perfect for:
- Skill trees (what unlocks what)
- Quest chains (dependencies)
- Map connections (rooms/areas)
- Social networks

## Simple Graph as Dict

```python
# Skill tree: skill -> prerequisites
skill_tree = {
    'basic_attack': [],
    'power_strike': ['basic_attack'],
    'whirlwind': ['power_strike'],
    'basic_defense': [],
    'shield_block': ['basic_defense']
}

def can_learn(skill, learned_skills):
    prereqs = skill_tree[skill]
    return all(prereq in learned_skills for prereq in prereqs)

learned = {'basic_attack', 'basic_defense'}
print(can_learn('power_strike', learned))  # True
print(can_learn('whirlwind', learned))     # False
```

## DAG = Directed Acyclic Graph

**Directed**: Edges have direction (A â†’ B)
**Acyclic**: No cycles (can't loop back)

```python
# DAG - valid skill tree
skills = {
    'spark': [],
    'fireball': ['spark'],
    'inferno': ['fireball']
}

# NOT a DAG - has cycle (invalid!)
broken = {
    'skill_a': ['skill_b'],
    'skill_b': ['skill_a']  # Cycle!
}
```

## Topological Sort

Order nodes so prerequisites come first:

```python
from collections import deque

def topological_sort(graph):
    # Count prerequisites for each node
    in_degree = {node: 0 for node in graph}
    for node in graph:
        for prereq in graph[node]:
            if prereq in in_degree:
                in_degree[node] += 1

    # Start with nodes that have no prerequisites
    queue = deque([n for n, d in in_degree.items() if d == 0])
    result = []

    while queue:
        node = queue.popleft()
        result.append(node)

        # For each node that requires this one
        for other in graph:
            if node in graph[other]:
                in_degree[other] -= 1
                if in_degree[other] == 0:
                    queue.append(other)

    return result

# Learn order: ['spark', 'fireball', 'inferno']
```

## Common Mistakes

```python
# Missing node reference
skills = {
    'fireball': ['spark']  # 'spark' not defined!
}

# Always define all nodes
skills = {
    'spark': [],
    'fireball': ['spark']
}
```
"""

[content.try_it]
prompt = "Check if all prerequisites are met to learn a skill"
starter = '''
skill_tree = {
    'slash': [],
    'power_slash': ['slash'],
    'mega_slash': ['power_slash', 'slash']
}

def can_learn(skill, learned):
    # Return True if all prerequisites are in learned
    pass

learned = {'slash', 'power_slash'}
print(can_learn('mega_slash', learned))  # Should be True
'''
solution = '''
skill_tree = {
    'slash': [],
    'power_slash': ['slash'],
    'mega_slash': ['power_slash', 'slash']
}

def can_learn(skill, learned):
    prereqs = skill_tree.get(skill, [])
    return all(prereq in learned for prereq in prereqs)

learned = {'slash', 'power_slash'}
print(can_learn('mega_slash', learned))  # True
'''

[connections]
prerequisites = ["dictionaries", "algorithms"]
enables = []
used_in = []
see_also = ["algorithms"]

[meta]
time_to_read = 60
difficulty = "intermediate"
tags = ["graphs", "dag", "data_structures"]
